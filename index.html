<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <title>ChatKit Netlify POC</title>
</head>
<body>
  <h2>ChatKit POC (Netlify)</h2>
  <button id="open">Open chat</button>
  <div id="chat" style="width:360px;height:520px;border:1px solid #ccc;margin-top:10px"></div>

  <script type="module">
    import { mountChat } from "https://cdn.jsdelivr.net/npm/@openai/chatkit-web/dist/chatkit.js";

    document.getElementById("open").onclick = async () => {
      const res = await fetch("/.netlify/functions/session", {
        method: "POST"
      });

      const data = await res.json();
      console.log("Session response:", data);

      const clientSecret =
        data.client_secret ||
        data.clientSecret ||
        data.client?.secret;

      if (!clientSecret) {
        alert("Geen client secret ontvangen");
        return;
      }

      mountChat({
        element: document.getElementById("chat"),
        clientSecret
      });
    };
  </script>
</body>
</html>
